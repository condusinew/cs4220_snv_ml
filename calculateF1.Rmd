---
title: "Variant Calling model evaluation demo"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

This notebook calculates F1 statistics (precision score, recall score and F1 score) for a bed file with predicted mutations.

## Set up and imports 

```{r imports}
# clean current envrionement variables
rm(list = ls())
# set your current working directory
setwd("/Users/cindyyu/Desktop/EEB313/cs4220_snv_ml"); print(getwd())
```


## Calculate F1 score metrics

```{r evaluateclassifier}



calc.F1 = function(pred,truth) {
  
  # append 'Chr' and 'StartPos'
  predv = paste(pred[,1],pred[,2])
  truthv = paste(truth[,1],truth[,2])
  
  res = data.frame(matrix(nrow = 1,ncol = 6))
  colnames(res) = c('TP','FP','FN','Precision','Recall','F1')

  res$TP = sum(predv %in% truthv)
  res$FP = sum(!(predv %in% truthv))
  res$FN = sum(!(truthv %in% predv))

  res$Precision = res$TP/(res$TP + res$FP)
  res$Recall = res$TP/(res$TP + res$FN)
  res$F1 = (2*res$Precision*res$Recall)/(res$Precision + res$Recall)
  
  return(res)
}


# load ground truth and predictions FOR REAL1
truth = read.table('all_truths.bed', header = F)
mypred = read.table('my-predictions.bed', header = FALSE) #changed to header = false

f1stats = calc.F1(mypred,truth)

print(f1stats)


# load ground truth and predictions (from consensus predictions)
mypred = read.table('my-consensus-predictions.bed', header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)


# load ground truth and predictions (from MUTECT predictions)
mypred = read.table("my-m2-predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)

#FREEBAYES
mypred = read.table("my-f-predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)


#VD
mypred = read.table("my-vd-predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)


#VS
mypred = read.table("my-vs-predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)

#BEST TWO
mypred = read.table("best-two-predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred,truth)

print(f1stats)

```
```{r}
truth = read.table('REALtest_TRUTH.bed', header = F)
mypred = read.table("REALtest_predictions.bed", header = FALSE) #changed to header = false
f1stats = calc.F1(mypred, truth)
pred = mypred
print(f1stats)
```


